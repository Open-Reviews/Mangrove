variables:
  S3_BUCKET: "mangrove.network"
  CI_DEBUG_TRACE: "true"
  BASE_URL: "https://mangrove.network"
  VUE_APP_API_URL: "https://api.mangrove.network"
  VUE_APP_FILES_URL: "https://files.mangrove.network"
  VUE_APP_UPLOAD_URL: "https://upload.mangrove.network"

deploy:
  only:
    - master

  image: wilson208/circleci-awscli:node

  cache:
    key: ${CI_COMMIT_REF_SLUG}
    paths:
    - client/node_modules/

  script:
  - cd client
  - yarn install
  - yarn generate
  - aws s3 rm s3://$S3_BUCKET --recursive
  - aws s3 cp --recursive ./dist s3://$S3_BUCKET
